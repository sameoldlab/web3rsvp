"use strict";var q=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var V=Object.prototype.hasOwnProperty;var G=(n,s)=>()=>(n&&(s=n(n=0)),s);var j=(n,s)=>{for(var e in s)q(n,e,{get:s[e],enumerable:!0})},H=(n,s,e,t)=>{if(s&&typeof s=="object"||typeof s=="function")for(let r of I(s))!V.call(n,r)&&r!==e&&q(n,r,{get:()=>s[r],enumerable:!(t=D(s,r))||t.enumerable});return n};var J=n=>H(q({},"__esModule",{value:!0}),n);var i=G(()=>{});var ee={};j(ee,{generateTestWallet:()=>Z,seedWallet:()=>Q});module.exports=J(ee);i();i();i();i();i();var $=require("@ethersproject/bytes");i();var x,K="Node";typeof globalThis<"u"&&globalThis.crypto&&(x=globalThis.crypto,K="Web");if(!x&&typeof require=="function")try{x=require("crypto"),K="Node"}catch(n){console.error("keystore expects a standard Web browser or Node environment.",n)}var w=x,B=K;i();var v=n=>B==="Node"?w.randomBytes(n):w.getRandomValues(new Uint8Array(n));i();var N=require("@fuel-ts/providers");i();i();var l="http://127.0.0.1:4000/graphql";i();var C=require("@fuel-ts/hdwallet"),z=require("@fuel-ts/mnemonic"),E=require("@fuel-ts/signer");i();var h=require("@ethersproject/bytes"),k=require("@fuel-ts/address"),g=require("@fuel-ts/constants"),M=require("@fuel-ts/interfaces"),F=require("@fuel-ts/math"),u=require("@fuel-ts/providers"),L=require("@fuel-ts/transactions");var T=class extends M.AbstractWallet{constructor(e,t=l){super();this.provider=this.connect(t),typeof e=="string"?this._address=k.Address.fromString(e):this._address=(0,k.addressify)(e)}get address(){return this._address}connect(e){if(e)typeof e=="string"?this.provider=new u.Provider(e):this.provider=e;else throw new Error("Provider is required");return this.provider}async getResourcesToSpend(e,t){return this.provider.getResourcesToSpend(this.address,e,t)}async getCoins(){let e=[],r;for(;;){let o=await this.provider.getCoins(this.address,void 0,{first:9999,after:r});if(e.push(...o),!(o.length>=9999))break;throw new Error(`Wallets with more than ${9999} coins are not yet supported`)}return e}async getMessages(){let e=[],r;for(;;){let o=await this.provider.getMessages(this.address,{first:9999,after:r});if(e.push(...o),!(o.length>=9999))break;throw new Error(`Wallets with more than ${9999} messages are not yet supported`)}return e}async getBalance(e=g.NativeAssetId){return await this.provider.getBalance(this.address,e)}async getBalances(){let e=[],r;for(;;){let o=await this.provider.getBalances(this.address,{first:9999,after:r});if(e.push(...o),!(o.length>=9999))break;throw new Error(`Wallets with more than ${9999} balances are not yet supported`)}return e}async fund(e){let t=e.calculateFee(),r=await this.getResourcesToSpend([t]);e.addResources(r)}async transfer(e,t,r=g.NativeAssetId,o={}){let c={gasLimit:L.MAX_GAS_PER_TX,...o},d=new u.ScriptTransactionRequest(c);d.addCoinOutput(e,t,r);let m=d.calculateFee(),f=[];m.assetId===(0,h.hexlify)(r)?(m.amount.add(t),f=[m]):f=[[t,r],m];let S=await this.getResourcesToSpend(f);return d.addResources(S),this.sendTransaction(d)}async withdrawToBaseLayer(e,t,r={}){let o=(0,h.arrayify)("0x".concat(e.toHexString().substring(2).padStart(64,"0"))),c=(0,h.arrayify)("0x".concat((0,F.bn)(t).toHex().substring(2).padStart(16,"0"))),m={script:new Uint8Array([...(0,h.arrayify)(u.withdrawScript.bytes),...o,...c]),gasLimit:L.MAX_GAS_PER_TX,...r},f=new u.ScriptTransactionRequest(m);f.addMessageOutputs();let S=f.calculateFee(),U=[];S.amount.add(t),U=[S];let _=await this.getResourcesToSpend(U);return f.addResources(_),this.sendTransaction(f)}async sendTransaction(e){let t=(0,u.transactionRequestify)(e);return await this.provider.addMissingVariables(t),this.provider.sendTransaction(t)}async simulateTransaction(e){let t=(0,u.transactionRequestify)(e);return await this.provider.addMissingVariables(t),this.provider.simulate(t)}async buildPredicateTransaction(e,t,r=g.NativeAssetId,o){let c={fundTransaction:!0,...o},d=new u.ScriptTransactionRequest({gasLimit:L.MAX_GAS_PER_TX,...c});d.addCoinOutput(e,t,r);let m=[];if(c.fundTransaction&&m.push(d.calculateFee()),m.length){let f=await this.getResourcesToSpend(m);d.addResources(f)}return d}async submitPredicate(e,t,r=g.NativeAssetId,o){let c=await this.buildPredicateTransaction(e,t,r,o);return(await this.sendTransaction(c)).waitForResult()}async submitSpendPredicate(e,t,r,o=g.NativeAssetId,c){return this.provider.submitSpendPredicate(e,t,this.address,r,o,c)}};i();var A=require("@fuel-ts/hasher"),b=require("@fuel-ts/providers"),O=require("@fuel-ts/signer");var P=class extends T{constructor(e,t=l){let r=new O.Signer(e);super(r.address,t);this.signer=()=>r,this.provider=this.connect(t)}get privateKey(){return this.signer().privateKey}get publicKey(){return this.signer().publicKey}async signMessage(e){return this.signer().sign((0,A.hashMessage)(e))}async signTransaction(e){let t=(0,b.transactionRequestify)(e),r=(0,A.hashTransaction)(t);return this.signer().sign(r)}async populateTransactionWitnessesSignature(e){let t=(0,b.transactionRequestify)(e),r=await this.signTransaction(t);return t.updateWitnessByOwner(this.address,r),t}async sendTransaction(e){let t=(0,b.transactionRequestify)(e);return await this.provider.addMissingVariables(t),this.provider.sendTransaction(await this.populateTransactionWitnessesSignature(t))}async simulateTransaction(e){let t=(0,b.transactionRequestify)(e);return await this.provider.addMissingVariables(t),this.provider.call(await this.populateTransactionWitnessesSignature(t),{utxoValidation:!0})}};P.defaultPath="m/44'/1179993420'/0'/0/0";var R=class extends T{unlock(s){return new a(s,this.provider)}},a=class extends P{lock(){return this.signer=()=>new E.Signer("0x00"),new R(this.address,this.provider)}static generate(s){let e=E.Signer.generatePrivateKey(s==null?void 0:s.entropy);return new a(e,s==null?void 0:s.provider)}static fromSeed(s,e){let r=C.HDWallet.fromSeed(s).derivePath(e||a.defaultPath);return new a(r.privateKey)}static fromMnemonic(s,e,t){let r=z.Mnemonic.mnemonicToSeed(s,t),c=C.HDWallet.fromSeed(r).derivePath(e||a.defaultPath);return new a(c.privateKey)}static fromExtendedKey(s){let e=C.HDWallet.fromExtendedKey(s);return new a(e.privateKey)}};var y=class{static fromAddress(s,e=l){return new R(s,e)}static fromPrivateKey(s,e=l){return new a(s,e)}};y.generate=a.generate,y.fromSeed=a.fromSeed,y.fromMnemonic=a.fromMnemonic,y.fromExtendedKey=a.fromExtendedKey;var Q=async(n,s)=>{let e=new a(process.env.GENESIS_SECRET||v(32),n.provider),t=await e.getResourcesToSpend(s),r=new N.ScriptTransactionRequest({gasLimit:1e4,gasPrice:1});r.addResources(t),s.map(N.coinQuantityfy).forEach(({amount:c,assetId:d})=>r.addCoinOutput(n.address,c,d)),await(await e.sendTransaction(r)).wait()},Z=async(n,s)=>{let e=y.generate({provider:n});return s&&await Q(e,s),e};0&&(module.exports={generateTestWallet,seedWallet});
//# sourceMappingURL=test-utils.js.map