"use strict";var T=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var P=(r,t)=>{for(var e in t)T(r,e,{get:t[e],enumerable:!0})},D=(r,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of U(t))!F.call(r,n)&&n!==e&&T(r,n,{get:()=>t[n],enumerable:!(o=C(t,n))||o.enumerable});return r};var k=r=>D(T({},"__esModule",{value:!0}),r);var W={};P(W,{decrypt:()=>R,encrypt:()=>O,keyFromPassword:()=>y,randomBytes:()=>m});module.exports=k(W);var v=require("@ethersproject/bytes"),x=require("@ethersproject/pbkdf2");var g,h="Node";typeof globalThis<"u"&&globalThis.crypto&&(g=globalThis.crypto,h="Web");if(!g&&typeof require=="function")try{g=require("crypto"),h="Node"}catch(r){console.error("keystore expects a standard Web browser or Node environment.",r)}var a=g,f=h;function i(r,t="base64"){return f==="Node"?Buffer.from(r,t):t==="utf-8"?new TextEncoder().encode(r):new Uint8Array(atob(r).split("").map(e=>e.charCodeAt(0)))}function p(r,t="base64"){return f==="Node"?Buffer.from(r).toString(t):btoa(String.fromCharCode.apply(null,new Uint8Array(r)))}function y(r,t){let e=i(String(r).normalize("NFKC"),"utf-8"),o=(0,x.pbkdf2)(e,t,1e5,32,"sha256");return(0,v.arrayify)(o)}var m=r=>f==="Node"?a.randomBytes(r):a.getRandomValues(new Uint8Array(r));var B="aes-256-ctr";async function w(r,t){let e=m(16),o=m(32),n=y(r,o),u=Uint8Array.from(Buffer.from(JSON.stringify(t),"utf-8")),s=a.createCipheriv(B,n,e),c=s.update(u);return c=Buffer.concat([c,s.final()]),{data:p(c),iv:p(e),salt:p(o)}}async function N(r,t){let e=i(t.iv),o=i(t.salt),n=y(r,o),u=i(t.data),s=a.createDecipheriv(B,n,e),c=s.update(u),l=Buffer.concat([c,s.final()]),b=Buffer.from(l).toString("utf-8");try{return JSON.parse(b)}catch{throw new Error("Invalid credentials")}}var A="AES-CTR";async function K(r,t){let e=m(16),o=m(32),n=y(r,o),u=Uint8Array.from(Buffer.from(JSON.stringify(t),"utf-8")),s={name:A,counter:e,length:64},c=await a.subtle.importKey("raw",n,s,!1,["encrypt"]),l=await a.subtle.encrypt(s,c,u);return{data:p(l),iv:p(e),salt:p(o)}}async function S(r,t){let e=i(t.iv),o=i(t.salt),n=y(r,o),u=i(t.data),s={name:A,counter:e,length:64},c=await a.subtle.importKey("raw",n,s,!1,["decrypt"]),l=await a.subtle.decrypt(s,c,u),b=new TextDecoder().decode(l);try{return JSON.parse(b)}catch{throw new Error("Invalid credentials")}}async function O(r,t){return f==="Node"?w(r,t):K(r,t)}async function R(r,t){return f==="Node"?N(r,t):S(r,t)}0&&(module.exports={decrypt,encrypt,keyFromPassword,randomBytes});
//# sourceMappingURL=index.js.map