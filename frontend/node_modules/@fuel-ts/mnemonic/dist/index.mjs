import{Base58 as S}from"@ethersproject/basex";import{hexDataSlice as U,concat as p,hexlify as F,arrayify as f}from"@ethersproject/bytes";import{pbkdf2 as W}from"@ethersproject/pbkdf2";import{computeHmac as j,sha256 as d,SupportedAlgorithm as z}from"@ethersproject/sha2";import{randomBytes as b}from"@fuel-ts/keystore";import{english as x}from"@fuel-ts/wordlists";import{arrayify as u}from"@ethersproject/bytes";import{sha256 as w}from"@ethersproject/sha2";function y(r){let e=r.normalize("NFKD"),t=[];for(let n=0;n<e.length;n+=1){let s=e.charCodeAt(n);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)===55296){n+=1;let o=e.charCodeAt(n);if(n>=e.length||(o&64512)!==56320)throw new Error("invalid utf-8 string");let c=65536+((s&1023)<<10)+(o&1023);t.push(c>>18|240),t.push(c>>12&63|128),t.push(c>>6&63|128),t.push(c&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return u(t)}function v(r){return(1<<r)-1}function M(r){return(1<<r)-1<<8-r}function g(r){return Array.isArray(r)?r:r.split(" ")}function T(r){return Array.isArray(r)?r.join(" "):r}function P(r){let e=[0],t=11;for(let o=0;o<r.length;o+=1)t>8?(e[e.length-1]<<=8,e[e.length-1]|=r[o],t-=8):(e[e.length-1]<<=t,e[e.length-1]|=r[o]>>8-t,e.push(r[o]&v(8-t)),t+=3);let n=r.length/4,s=u(w(r))[0]&M(n);return e[e.length-1]<<=n,e[e.length-1]|=s>>8-n,e}function E(r,e){let t=Math.ceil(11*r.length/8),n=u(new Uint8Array(t)),s=0;for(let a=0;a<r.length;a+=1){let m=e.indexOf(r[a].normalize("NFKD"));if(m===-1)throw new Error("invalid mnemonic");for(let h=0;h<11;h+=1)m&1<<10-h&&(n[s>>3]|=1<<7-s%8),s+=1}let o=32*r.length/3,c=r.length/3,l=M(c);if((u(w(n.slice(0,o/8)))[0]&l)!==(n[n.length-1]&l))throw new Error("invalid checksum");return n.slice(0,o/8)}var C=y("Bitcoin seed"),D=76066276,I=70615956;function L(r){if(r.length!==2048)throw new Error("Invalid word list length")}function N(r){if(r.length%4!==0||r.length<16||r.length>32)throw new Error("invalid entropy")}function K(r){if(![12,15,18,21,24].includes(r.length))throw new Error("invalid mnemonic size")}var i=class{constructor(e=x){this.wordlist=e,L(this.wordlist)}mnemonicToEntropy(e){return i.mnemonicToEntropy(e,this.wordlist)}entropyToMnemonic(e){return i.entropyToMnemonic(e,this.wordlist)}static mnemonicToEntropy(e,t=x){let n=g(e);return K(n),F(E(n,t))}static entropyToMnemonic(e,t=x){let n=f(e,{allowMissingPrefix:!0});return L(t),N(n),P(n).map(s=>t[s]).join(" ")}static mnemonicToSeed(e,t=""){K(g(e));let n=y(T(e)),s=y(`mnemonic${t}`);return W(n,s,2048,64,"sha512")}static mnemonicToMasterKeys(e,t=""){let n=i.mnemonicToSeed(e,t);return i.masterKeysFromSeed(n)}static masterKeysFromSeed(e){let t=f(e);if(t.length<16||t.length>64)throw new Error("invalid seed");return f(j(z.sha512,C,t))}static seedToExtendedKey(e,t=!1){let n=i.masterKeysFromSeed(e),s=f(t?I:D),o="0x00",c="0x00000000",l="0x00000000",A=n.slice(32),a=n.slice(0,32),m=p([s,o,c,l,A,p(["0x00",a])]),h=U(d(d(m)),0,4);return S.encode(p([m,h]))}static generate(e=32,t=""){let n=t?d(p([b(e),f(t)])):b(e);return i.entropyToMnemonic(n)}},R=i;export{R as Mnemonic};
//# sourceMappingURL=index.mjs.map