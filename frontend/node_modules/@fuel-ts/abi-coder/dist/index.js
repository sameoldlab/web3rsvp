"use strict";var oe=Object.defineProperty;var Re=Object.getOwnPropertyDescriptor;var Pe=Object.getOwnPropertyNames;var De=Object.prototype.hasOwnProperty;var Je=(s,e)=>{for(var t in e)oe(s,t,{get:e[t],enumerable:!0})},Le=(s,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Pe(e))!De.call(s,n)&&n!==t&&oe(s,n,{get:()=>e[n],enumerable:!(r=Re(e,n))||r.enumerable});return s};var Se=s=>Le(oe({},"__esModule",{value:!0}),s);var fe=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var I=(s,e,t)=>(fe(s,e,"read from private field"),t?t.call(s):e.get(s)),j=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},v=(s,e,t,r)=>(fe(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);var $e={};Je($e,{ABI:()=>F,ASSET_ID_LEN:()=>lt,AbiCoder:()=>O,ArrayCoder:()=>V,B256Coder:()=>R,BYTES_32:()=>yt,BooleanCoder:()=>b,ByteCoder:()=>P,CONTRACT_ID_LEN:()=>gt,Coder:()=>i,EnumCoder:()=>A,Fragment:()=>K,FunctionFragment:()=>x,Interface:()=>E,MAX_INPUTS:()=>mt,NumberCoder:()=>D,OPTION_CODER_TYPE:()=>Y,StringCoder:()=>J,StructCoder:()=>S,TRANSACTION_SCRIPT_FIXED_SIZE:()=>ht,TupleCoder:()=>C,U64Coder:()=>y,VEC_CODER_TYPE:()=>se,VM_TX_MEMORY:()=>ft,VecCoder:()=>h,WORD_SIZE:()=>Fe,arrayRegEx:()=>N,enumRegEx:()=>X,filterEmptyParams:()=>M,genericRegEx:()=>de,getVectorAdjustments:()=>pe,hasOptionTypes:()=>ce,isFlatJsonAbi:()=>ne,isReferenceType:()=>ue,stringRegEx:()=>q,structRegEx:()=>z,tupleRegEx:()=>ae});module.exports=Se($e);var he=require("@ethersproject/logger"),Ue=new he.Logger("0.21.0"),i=class{constructor(e,t,r){this.name=e,this.type=t,this.encodedLength=r}throwError(e,t){throw Ue.throwArgumentError(e,this.name,t),new Error("unreachable")}setOffset(e){this.offset=e}};var Te=require("@ethersproject/bytes");var V=class extends i{constructor(t,r){super("array",`[${t.type}; ${r}]`,r*t.encodedLength);this.coder=t,this.length=r}encode(t){return Array.isArray(t)||this.throwError("expected array value",t),this.length!==t.length&&this.throwError("Types/values length mismatch",t),(0,Te.concat)(Array.from(t).map(r=>this.coder.encode(r)))}decode(t,r){let n=r;return[Array(this.length).fill(0).map(()=>{let a;return[a,n]=this.coder.decode(t,n),a}),n]}};var be=require("@ethersproject/bytes"),H=require("@fuel-ts/math");var R=class extends i{constructor(){super("b256","b256",32)}encode(e){let t;try{t=(0,be.arrayify)(e)}catch{this.throwError(`Invalid ${this.type}`,e)}return t.length!==32&&this.throwError(`Invalid ${this.type}`,e),t}decode(e,t){let r=e.slice(t,t+32);return(0,H.bn)(r).isZero()&&(r=new Uint8Array(32)),r.length!==32&&this.throwError("Invalid size for b256",r),[(0,H.toHex)(r,32),t+32]}};var B=require("@fuel-ts/math");var b=class extends i{constructor(){super("boolean","boolean",8)}encode(e){let t;try{t=(0,B.toBytes)(e?1:0)}catch{this.throwError("Invalid bool",e)}return t.length>1&&this.throwError("Invalid bool",e),(0,B.toBytes)(t,8)}decode(e,t){let r=(0,B.bn)(e.slice(t,t+8));return r.isZero()?[!1,t+8]:(r.eq((0,B.bn)(1))||this.throwError("Invalid boolean value",r),[!0,t+8])}};var k=require("@fuel-ts/math");var P=class extends i{constructor(){super("byte","byte",8)}encode(e){let t;try{t=(0,k.toBytes)(e,1)}catch{this.throwError("Invalid Byte",e)}return(0,k.toBytes)(t,8)}decode(e,t){let r=e.slice(t,t+8),n=(0,k.bn)(r);return n.gt((0,k.bn)(255))&&this.throwError("Invalid Byte",n),[Number(n),t+8]}};var Ae=require("@ethersproject/bytes"),Ce=require("@fuel-ts/math");var Q=require("@fuel-ts/math");var y=class extends i{constructor(){super("u64","u64",8)}encode(e){let t;try{t=(0,Q.toBytes)(e,8)}catch{this.throwError(`Invalid ${this.type}`,e)}return t}decode(e,t){let r=e.slice(t,t+8);return r=r.slice(0,8),[(0,Q.bn)(r),t+8]}};var Z,_,A=class extends i{constructor(t,r){let n=new y,o=Object.values(r).reduce((a,d)=>Math.max(a,d.encodedLength),0);super("enum",`enum ${t}`,n.encodedLength+o);j(this,Z,void 0);j(this,_,void 0);this.name=t,this.coders=r,v(this,Z,n),v(this,_,o)}encode(t){let[r,...n]=Object.keys(t);if(!r)throw new Error("A field for the case must be provided");if(n.length!==0)throw new Error("Only one field must be provided");let o=this.coders[r],a=Object.keys(this.coders).indexOf(r),d=o.encode(t[r]),c=new Uint8Array(I(this,_)-o.encodedLength);return(0,Ae.concat)([I(this,Z).encode(a),c,d])}decode(t,r){let n=r,o;[o,n]=new y().decode(t,n);let a=(0,Ce.toNumber)(o),d=Object.keys(this.coders)[a];if(!d)throw new Error(`Invalid caseIndex "${a}". Valid cases: ${Object.keys(this.coders)}`);let c=this.coders[d];return n+=I(this,_)-c.encodedLength,[o,n]=c.decode(t,n),[{[d]:o},n]}};Z=new WeakMap,_=new WeakMap;var W=require("@fuel-ts/math");var D=class extends i{constructor(t){super("number",t,8);switch(this.baseType=t,t){case"u8":this.length=1;break;case"u16":this.length=2;break;case"u32":default:this.length=4;break}}encode(t){let r;try{r=(0,W.toBytes)(t)}catch{this.throwError(`Invalid ${this.baseType}`,t)}return r.length>this.length&&this.throwError(`Invalid ${this.baseType}. Too many bytes.`,t),(0,W.toBytes)(r,8)}decode(t,r){let n=t.slice(r,r+8);return n=n.slice(8-this.length,8),[(0,W.toNumber)(n),r+8]}};var xe=require("@ethersproject/bytes"),ee=require("@ethersproject/strings");var $,J=class extends i{constructor(t){let r=(8-t)%8;r=r<0?r+8:r;super("string",`str[${t}]`,t+r);j(this,$,void 0);this.length=t,v(this,$,r)}encode(t){let r=(0,ee.toUtf8Bytes)(t.slice(0,this.length)),n=new Uint8Array(I(this,$));return(0,xe.concat)([r,n])}decode(t,r){let n=t.slice(r,r+this.length),o=(0,ee.toUtf8String)(n),a=I(this,$);return[o,r+this.length+a]}};$=new WeakMap;var Oe=require("@ethersproject/bytes");var L=class extends A{encode(e){return super.encode(this.toSwayOption(e))}toSwayOption(e){return e!==void 0?{Some:e}:{None:[]}}decode(e,t){let[r,n]=super.decode(e,t);return[this.toOption(r),n]}toOption(e){if(e&&"Some"in e)return e.Some}};var S=class extends i{constructor(t,r){let n=Object.values(r).reduce((o,a)=>o+a.encodedLength,0);super("struct",`struct ${t}`,n);this.name=t,this.coders=r}encode(t){let r=Object.keys(this.coders).map(n=>{let o=this.coders[n],a=t[n];return!(o instanceof L)&&a==null&&this.throwError(`Invalid ${this.type}. Field "${n}" not present.`,t),o.encode(a)});return(0,Oe.concat)(r)}decode(t,r){let n=r;return[Object.keys(this.coders).reduce((a,d)=>{let c=this.coders[d],u;return[u,n]=c.decode(t,n),a[d]=u,a},{}),n]}};var Ee=require("@ethersproject/bytes");var C=class extends i{constructor(t){let r=t.reduce((n,o)=>n+o.encodedLength,0);super("tuple",`(${t.map(n=>n.type).join(", ")})`,r);this.coders=t}encode(t){return this.coders.length!==t.length&&this.throwError("Types/values length mismatch",{value:t}),(0,Ee.concat)(this.coders.map((r,n)=>r.encode(t[n])))}decode(t,r){let n=r;return[this.coders.map(a=>{let d;return[d,n]=a.decode(t,n),d}),n]}};var ie=require("@ethersproject/bytes");var Y="enum Option",se="struct Vec",q=/str\[(?<length>[0-9]+)\]/,N=/\[(?<item>[\w\s\\[\]]+);\s*(?<length>[0-9]+)\]/,z=/^struct (?<name>\w+)$/,X=/^enum (?<name>\w+)$/,ae=/^\((?<items>.*)\)$/,de=/^generic (?<name>\w+)$/,Fe=8,yt=32,mt=255,lt=32,gt=32,ft=10240,ht=104;var Be=3,h=class extends i{constructor(t){super("struct","struct Vec",0);this.coder=t}static getBaseOffset(){return Be*8}getEncodedVectorData(t){Array.isArray(t)||this.throwError("expected array value",t);let r=Array.from(t).map(n=>this.coder.encode(n));return(0,ie.concat)(r)}encode(t){Array.isArray(t)||this.throwError("expected array value",t);let r=[],n=this.offset||0;return r.push(new y().encode(n)),r.push(new y().encode(t.length)),r.push(new y().encode(t.length)),(0,ie.concat)(r)}decode(t,r){return this.throwError("unexpected Vec decode","not implemented"),[void 0,r]}};function M(s){return s.filter(e=>(e==null?void 0:e.type)!=="()"&&e!=="()")}function ce(s){return s.some(e=>(e==null?void 0:e.type)===Y)}function pe(s,e,t=0){let r=[],n=s.map((d,c)=>{if(!(d instanceof h))return{byteLength:d.encodedLength};let u=d.getEncodedVectorData(e[c]);return r.push(u),{vecByteLength:u.byteLength}}),o=r.length*h.getBaseOffset()+t,a=s.map((d,c)=>d instanceof h?n.reduce((u,l,U)=>"byteLength"in l?u+l.byteLength:U===0&&U===c?o:U<c?u+l.vecByteLength+o:u,0):0);return s.forEach((d,c)=>d.setOffset(a[c])),r}var K=class{constructor(e){this.inputs=[];this.outputs=[];this.type=e.type,this.name=e.name,this.inputs=e.inputs,this.outputs=e.outputs}};var we=require("@ethersproject/properties");function ke(s,e){Object.keys(e).forEach(t=>{let r=t,n=e[r];(0,we.defineReadOnly)(s,r,n)})}var g=class{constructor(e){ke(this,e),this.isParamType=!0,Object.freeze(this)}getSignaturePrefix(){if(this.type){if(z.test(this.type))return"s";if(N.test(this.type))return"a";if(X.test(this.type))return"e"}return""}getSignatureContent(){var n,o;let e=this.type||"";if(e==="raw untyped ptr")return"rawptr";let t=(n=N.exec(e))==null?void 0:n.groups;if(t)return`[${this.components?this.components[0].getSighash():t.item};${t.length}]`;let r=(o=q.exec(e))==null?void 0:o.groups;if(r)return`str[${r.length}]`;if(Array.isArray(this.components)){let a=Array.isArray(this.typeArguments)?`<${this.typeArguments.map(c=>c.getSighash()).join(",")}>`:"",d=`(${this.components.map(c=>c.getSighash()).join(",")})`;return`${a}${d}`}return e}getSighash(){let e=this.getSignaturePrefix(),t=this.getSignatureContent();return`${e}${t}`}static fromObject(e){return g.isParamType(e)?e:new g({name:e.name,type:e.type,components:e.components?e.components.map(g.fromObject):void 0,typeArguments:e.typeArguments?e.typeArguments.map(g.fromObject):void 0})}static isParamType(e){return Boolean(e==null?void 0:e.isParamType)}};var x=class extends K{static fromObject(e){let{inputs:t=[],outputs:r=[]}=e,n={type:"function",name:e.name,inputs:t.map(g.fromObject),outputs:r.map(g.fromObject)};return new x(n)}getInputsSighash(){let e=this.inputs.map(t=>t.getSighash());return`${this.name}(${e.join(",")})`}};var f=require("@ethersproject/bytes"),Ie=require("@ethersproject/logger"),Ve=require("@ethersproject/sha2"),me=require("@ethersproject/strings");var G=require("@ethersproject/bytes"),re=require("@ethersproject/logger");var te=new re.Logger("0.21.0"),O=class{constructor(){te.checkNew(new.target,O)}getCoder(e){var d,c,u,l,U,le;switch(e.type){case"u8":case"u16":case"u32":return new D(e.type);case"u64":case"raw untyped ptr":return new y;case"bool":return new b;case"byte":return new P;case"b256":return new R;default:}let t=(d=N.exec(e.type))==null?void 0:d.groups;if(t){let m=parseInt(t.length,10),T=(c=e.components)==null?void 0:c[0];if(!T)throw new Error("Expected array type to have an item component");let w=this.getCoder(T);return new V(w,m)}let r=(u=q.exec(e.type))==null?void 0:u.groups;if(r){let m=parseInt(r.length,10);return new J(m)}if(e.type===se&&Array.isArray(e.typeArguments)){let m=e.typeArguments[0];if(!m)throw new Error("Expected Vec type to have a type argument");let T=this.getCoder(m);return new h(T)}let n=(l=z.exec(e.type))==null?void 0:l.groups;if(n&&Array.isArray(e.components)){let m=e.components.reduce((T,w)=>(T[w.name]=this.getCoder(w),T),{});return new S(n.name,m)}let o=(U=X.exec(e.type))==null?void 0:U.groups;if(o&&Array.isArray(e.components)){let m=e.components.reduce((w,ge)=>(w[ge.name]=this.getCoder(ge),w),{});return e.type===Y?new L(o.name,m):new A(o.name,m)}if(((le=ae.exec(e.type))==null?void 0:le.groups)&&Array.isArray(e.components)){let m=e.components.map(T=>this.getCoder(T));return new C(m)}return te.throwArgumentError("Invalid type","type",e.type)}encode(e,t,r=0){let n=M(e),o=t.slice();Array.isArray(t)&&n.length!==t.length&&(ce(e)?(o.length=e.length,o.fill(void 0,t.length)):te.throwError("Types/values length mismatch",re.Logger.errors.INVALID_ARGUMENT,{count:{types:n.length,values:t.length},value:{types:e,values:t}}));let a=n.map(l=>this.getCoder(l)),d=pe(a,o,r),u=new C(a).encode(o);return(0,G.concat)([u,(0,G.concat)(d)])}decode(e,t){let r=(0,G.arrayify)(t),n=M(e),o=l=>{l!==r.length&&te.throwError("Types/values length mismatch",re.Logger.errors.INVALID_ARGUMENT,{count:{types:n.length,values:r.length},value:{types:n,bytes:r}})};if(e.length===0||n.length===0){o(r.length?8:0);return}let a=n.map(l=>this.getCoder(l)),d=new C(a),[c,u]=d.decode(r,0);return o(u),c}};var ne=s=>!Array.isArray(s),F=class{constructor(e){this.types=e.types,this.functions=e.functions,this.loggedTypes=e.loggedTypes}parseLoggedType(e){return g.fromObject(this.parseInput(e.loggedType))}parseInput(e,t=new Map){let r=this.types[e.type],n,o;if(!r)throw new Error(`${e.type} not found`);if(Array.isArray(e.typeArguments)&&(o=e.typeArguments.map(a=>this.parseInput(a,t))),Array.isArray(r.typeParameters)&&Array.isArray(o)&&r.typeParameters.forEach((a,d)=>{o!=null&&o[d]&&t.set(a,o[d])}),Array.isArray(r.components)&&(n=r.components.map(a=>this.parseInput(a,t))),de.test(r.type)){let a=t.get(r.typeId);if(a)return{...a,name:e.name}}return{type:r.type,name:e.name,typeArguments:o,components:n}}static unflatten(e){return ne(e)?new F(e).unflatten():e}unflattenLoggedTypes(){return this.loggedTypes.map(e=>({...e,abiFragmentType:[this.parseLoggedType(e)]}))}unflatten(){return this.functions.map(e=>({type:"function",name:e.name,inputs:(e.inputs||[]).map(t=>this.parseInput(t)),outputs:e.output?[this.parseInput(e.output)]:[]}))}},ue=s=>{switch(s){case"u8":case"u16":case"u32":case"u64":case"bool":return!1;default:return!0}};var ye=new Ie.Logger("0.21.0"),_e=s=>{let e=[];return s.forEach(t=>{t.type==="function"&&e.push(x.fromObject(t))}),e},E=class{constructor(e){this.abi=ne(e)?new F(e):null,this.fragments=_e(F.unflatten(e)),this.types=this.abi?this.abi.types:[],this.loggedTypes=this.abi?this.abi.unflattenLoggedTypes():[],this.abiCoder=new O,this.functions={},this.fragments.forEach(t=>{let r={};switch(t.type){case"function":r=this.functions;break;default:return}let n=t.getInputsSighash();if(r[n]){ye.warn(`duplicate definition - ${n}`);return}r[n]=t})}static getSighash(e){let t=typeof e=="string"?(0,me.toUtf8Bytes)(e):(0,me.toUtf8Bytes)(e.getInputsSighash());return(0,f.concat)([new Uint8Array(4),(0,f.arrayify)((0,Ve.sha256)(t)).slice(0,4)])}getFunction(e){if(this.functions[e])return this.functions[e];let t=Object.values(this.functions).find(r=>(0,f.hexlify)(E.getSighash(r))===e||r.name===e);return t||ye.throwArgumentError(`function ${e} not found.`,"data",t)}decodeFunctionData(e,t){let r=typeof e=="string"?this.getFunction(e):e,n=(0,f.arrayify)(t);return(0,f.hexlify)(n.slice(0,8))!==(0,f.hexlify)(E.getSighash(r))&&ye.throwArgumentError(`data signature does not match function ${r.name}.`,"data",(0,f.hexlify)(n)),this.abiCoder.decode(r.inputs,n.slice(16))}encodeFunctionData(e,t,r=0){let n=typeof e=="string"?this.getFunction(e):e;if(!n)throw new Error("Fragment not found");let o=E.getSighash(n),a=M(n.inputs);if(a.length===0)return o;let d=a.length>1||ue(a[0].type),c=this.abiCoder.encode(a,t,r);return(0,f.concat)([o,new b().encode(d),c])}decodeFunctionResult(e,t){let r=typeof e=="string"?this.getFunction(e):e,n=(0,f.arrayify)(t);return this.abiCoder.decode(r.outputs,n)}decodeLog(e,t){let r=this.loggedTypes.find(n=>n.logId===t);if(!(r!=null&&r.abiFragmentType))throw new Error(`Log ID - ${t} unknown`);return this.abiCoder.decode(r.abiFragmentType,e)}encodeFunctionResult(e,t){let r=typeof e=="string"?this.getFunction(e):e;if(!r)throw new Error("Fragment not found");return this.abiCoder.encode(r.outputs,t)}};0&&(module.exports={ABI,ASSET_ID_LEN,AbiCoder,ArrayCoder,B256Coder,BYTES_32,BooleanCoder,ByteCoder,CONTRACT_ID_LEN,Coder,EnumCoder,Fragment,FunctionFragment,Interface,MAX_INPUTS,NumberCoder,OPTION_CODER_TYPE,StringCoder,StructCoder,TRANSACTION_SCRIPT_FIXED_SIZE,TupleCoder,U64Coder,VEC_CODER_TYPE,VM_TX_MEMORY,VecCoder,WORD_SIZE,arrayRegEx,enumRegEx,filterEmptyParams,genericRegEx,getVectorAdjustments,hasOptionTypes,isFlatJsonAbi,isReferenceType,stringRegEx,structRegEx,tupleRegEx});
//# sourceMappingURL=index.js.map