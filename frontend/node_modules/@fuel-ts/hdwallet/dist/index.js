"use strict";var y=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var A=Object.prototype.hasOwnProperty;var L=(n,e)=>{for(var t in e)y(n,t,{get:e[t],enumerable:!0})},U=(n,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of B(e))!A.call(n,r)&&r!==t&&y(n,r,{get:()=>e[r],enumerable:!(s=P(e,r))||s.enumerable});return n};var S=n=>U(y({},"__esModule",{value:!0}),n);var T={};L(T,{HDWallet:()=>k});module.exports=S(T);var u=require("@ethersproject/basex"),i=require("@ethersproject/bytes"),a=require("@ethersproject/sha2"),f=require("@fuel-ts/math"),g=require("@fuel-ts/mnemonic"),l=require("@fuel-ts/signer"),v=2147483648,w=(0,i.hexlify)("0x0488ade4"),K=(0,i.hexlify)("0x0488b21e"),E=(0,i.hexlify)("0x04358394"),m=(0,i.hexlify)("0x043587cf");function x(n){return u.Base58.encode((0,i.concat)([n,(0,i.hexDataSlice)((0,a.sha256)((0,a.sha256)(n)),0,4)]))}function R(n=!1,e=!1){return n?e?m:K:e?E:w}function M(n){return[K,m].includes((0,i.hexlify)(n.slice(0,4)))}function N(n){return[w,E,K,m].includes((0,i.hexlify)(n.slice(0,4)))}function V(n,e=0){let t=n.split("/");if(t.length===0||t[0]==="m"&&e!==0)throw new Error(`invalid path - ${n}`);return t[0]==="m"&&t.shift(),t.map(s=>~s.indexOf("'")?parseInt(s,10)+v:parseInt(s,10))}var p=class{constructor(e){this.depth=0;this.index=0;this.fingerprint=(0,i.hexlify)("0x00000000");this.parentFingerprint=(0,i.hexlify)("0x00000000");if(e.privateKey){let t=new l.Signer(e.privateKey);this.publicKey=(0,i.hexlify)(t.compressedPublicKey),this.privateKey=(0,i.hexlify)(e.privateKey)}else{if(!e.publicKey)throw new Error("Public and Private Key are missing!");this.publicKey=(0,i.hexlify)(e.publicKey)}this.parentFingerprint=e.parentFingerprint||this.parentFingerprint,this.fingerprint=(0,i.hexDataSlice)((0,a.ripemd160)((0,a.sha256)(this.publicKey)),0,4),this.depth=e.depth||this.depth,this.index=e.index||this.index,this.chainCode=e.chainCode}get extendedKey(){return this.toExtendedKey()}deriveIndex(e){let t=this.privateKey&&(0,i.arrayify)(this.privateKey),s=(0,i.arrayify)(this.publicKey),r=(0,i.arrayify)(this.chainCode),o=new Uint8Array(37);if(e&v){if(!t)throw new Error("Derive hardened requires privateKey");o.set(t,1)}else o.set((0,i.arrayify)(this.publicKey));o.set((0,f.toBytes)(e,4),33);let d=(0,i.arrayify)((0,a.computeHmac)(a.SupportedAlgorithm.sha512,r,o)),h=d.slice(0,32),c=d.slice(32);if(t){let I="0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",F=(0,f.bn)(h).add(t).mod(I).toBytes(32);return new p({privateKey:F,chainCode:c,index:e,depth:this.depth+1,parentFingerprint:this.fingerprint})}let C=new l.Signer((0,i.hexlify)(h)).addPoint(s);return new p({publicKey:C,chainCode:c,index:e,depth:this.depth+1,parentFingerprint:this.fingerprint})}derivePath(e){return V(e,this.depth).reduce((s,r)=>s.deriveIndex(r),this)}toExtendedKey(e=!1,t=!1){if(this.depth>=256)throw new Error("Depth too large!");let s=R(this.privateKey==null||e,t),r=(0,i.hexlify)(this.depth),o=this.parentFingerprint,d=(0,f.toHex)(this.index,4),h=this.chainCode,c=this.privateKey!=null&&!e?(0,i.concat)(["0x00",this.privateKey]):this.publicKey,b=(0,i.concat)([s,r,o,d,h,c]);return x(b)}static fromSeed(e){let t=g.Mnemonic.masterKeysFromSeed(e);return new p({chainCode:(0,i.arrayify)(t.slice(32)),privateKey:(0,i.arrayify)(t.slice(0,32))})}static fromExtendedKey(e){let t=u.Base58.decode(e),s=x(t.slice(0,78))===e;if(t.length!==82||!N(t))throw new Error("Invalid extended key");if(!s)throw new Error("Invalid checksum key");let r=t[4],o=(0,i.hexlify)(t.slice(5,9)),d=parseInt((0,i.hexlify)(t.slice(9,13)).substring(2),16),h=(0,i.hexlify)(t.slice(13,45)),c=t.slice(45,78);if(r===0&&o!=="0x00000000"||r===0&&d!==0)throw new Error("Invalid depth");if(M(t)){if(c[0]!==3)throw new Error("Invalid public extended key");return new p({publicKey:c,chainCode:h,index:d,depth:r,parentFingerprint:o})}if(c[0]!==0)throw new Error("Invalid private extended key");return new p({privateKey:c.slice(1),chainCode:h,index:d,depth:r,parentFingerprint:o})}},k=p;0&&(module.exports={HDWallet});
//# sourceMappingURL=index.js.map